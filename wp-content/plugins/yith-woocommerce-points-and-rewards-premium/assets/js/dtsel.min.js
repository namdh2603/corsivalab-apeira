!function(){"use strict";var e=["DAYS","MONTHS","YEARS"];function t(t,n){n=n||{};var i={defaultView:e[0],dateFormat:"yyyy-mm-dd",timeFormat:"HH:MM:SS",showDate:!0,showTime:!1,paddingX:5,paddingY:5,direction:"TOP",localization:{weekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","December"]}};if(!t)throw TypeError("input element or selector required for contructor");if(Object.getPrototypeOf(t)===String.prototype){var r=document.querySelectorAll(t);if(!r[0])throw Error('"'+t+'" not found.');t=r[0]}this.config=jQuery.extend(!0,i,n),this.dateFormat=this.config.dateFormat,this.timeFormat=this.config.timeFormat,this.dateFormatRegEx=new RegExp("yyyy|yy|mm|dd","gi"),this.timeFormatRegEx=new RegExp("hh|mm|ss|a","gi"),this.inputElem=t,this.dtbox=null,this.localization=this.config.localization,this.setup()}function n(e,t){var n=this,i={},r={};function o(e,t){return{get:function(){var n=r[e];return void 0===n?t:n},set:function(t){var o=n.state,s=i[e]||[];r[e]=t;for(var a=0;a<s.length;a++)s[a].bind(n)(r,o)}}}this.weekdays=t.localization.weekdays,this.months=t.localization.months,this.months_short=t.localization.months_short,Object.defineProperties(this,{visible:o("visible",!1),bodyType:o("bodyType",t.config.defaultView),value:o("value"),year:o("year",0),month:o("month",0),day:o("day",0),hours:o("hours",0),minutes:o("minutes",0),seconds:o("seconds",0),cancelBlur:o("cancelBlur",0),addHandler:{value:function(e,t){if(!e||!t)return!1;i[e]||(i[e]=[]),i[e].push(t)}},month_long:{get:function(){return n.months[n.month]}},month_short:{get:function(){return n.months_short[n.month]}},state:{get:function(){return Object.assign({},r)}},time:{get:function(){return 60*n.hours*60*1e3+60*n.minutes*1e3+1e3*n.seconds}}}),this.el={},this.settings=t,this.elem=e,this.setup()}function i(e){var t=e.getBoundingClientRect(),n=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,i=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{left:t.left+n,top:t.top+i}}function r(e){for(;e.children.length;)e.removeChild(e.children[0])}function o(e,t){try{return t.appendChild(e),e}catch(e){console.trace(e)}}function s(){this._funcs={}}function a(e,t,n,i){var r,o,a={canSkip:new s,updateValue:new s},l=(r=Object.keys(n),o=t,r.sort((function(e,t){var n=o.indexOf(e),i=o.indexOf(t),r=0;return n<i?r=-1:i<n?r=1:e.length>t.length?r=-1:t.length>e.length&&(r=1),r}))),d=function(e,t){for(var n=[],i=0,r=0;r<e.length;r++){var o=e[r];t.slice(i).indexOf(o)>-1&&(i+=o.length,n.push(o))}return n}(l,t),h=0;i&&i(a);for(var u=0;u<l.length;u++){var c=l[u],p=t.indexOf(c),f=h,m=null,y=!1,v=a.canSkip.get(c);h=h||p;for(var g=0;g<v.length;g++)if(v[g](n)){y=!0;break}if(p>-1&&!y){var b=null,w=h+c.length,T=-1,x=u+1;for(f+=c.length;-1==T&&x<l.length;){var S=l[x];x+=1,-1!==d.indexOf(S)&&(T=S?t.indexOf(S):-1)}if(T>-1&&(b=t.slice(w,T))){var O=e.slice(h).indexOf(b);O&&O>-1&&(f=(w=O+h)+b.length)}m=parseInt(e.slice(h,w));v=a.updateValue.get(c);for(var E=0;E<v.length;E++)m=v[E](m,n,h,w)}n[c]={index:h,value:m},h=f}return n}function l(e,t){var n={yyyy:null,yy:null,mm:null,dd:null},i=(t.dateFormat||"").toLowerCase();if(!i)throw new TypeError("dateFormat not found ("+t.dateFormat+")");var r=(n=a(e,i,n,(function(e){e.canSkip.add("yy",(function(e){return e.yyyy.value})),e.updateValue.add("yy",(function(e){return 100*Math.floor((new Date).getFullYear()/100)+e}))}))).yyyy.value||n.yy.value,o=n.mm.value-1,s=n.dd.value;return new Date(r,o,s)}function d(e,t){var n=(t.timeFormat||"").toLowerCase();if(!n)throw new TypeError("timeFormat not found ("+t.timeFormat+")");var i,r=(i=a(e,n,i={hh:null,mm:null,ss:null,a:null},(function(t){t.updateValue.add("a",(function(t,n,i,r){return e.slice(i,i+2)}))}))).hh.value,o=i.mm.value,s=i.ss.value,l=i.a.value,d=l?l.toLowerCase():l;return l&&["am","pm"].indexOf(d)>-1&&("am"==d&&12==r?r=0:"pm"==d&&(r+=12)),60*r*60*1e3+60*o*1e3+1e3*s}function h(e,t){var n=t.dateFormat.toLowerCase(),i=e.getDate(),r=e.getMonth()+1,o=e.getFullYear(),s=o%100,a={dd:i<10?"0"+i:i,mm:r<10?"0"+r:r,yyyy:o,yy:s<10?"0"+s:s};return n.replace(t.dateFormatRegEx,(function(e){return a[e]}))}function u(e,t){var n=t.timeFormat,i=n.toLowerCase(),r=e.getHours(),o=e.getMinutes(),s=e.getSeconds(),a=null,l=null;i.indexOf("a")>-1&&(a=r>=12?"pm":"am",a=n.indexOf("A")>-1?a.toUpperCase():a,l=0==r?"12":r>12?r%12:r);var d={hh:a?l:r<10?"0"+r:r,mm:o<10?"0"+o:o,ss:s<10?"0"+s:s,a:a};return i.replace(t.timeFormatRegEx,(function(e){return d[e]}))}function c(e,t){return!(!e||!t)&&(e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate())}function p(e,t,n){n=n||0;var i=""+(parseInt(e)||n),r=Math.max(t,i.length)-i.length;return(""+n).repeat(r)+i}t.prototype.setup=function(){var e=this.inputElemHandler.bind(this);this.inputElem.addEventListener("focus",e,!1),this.inputElem.addEventListener("blur",e,!1)},t.prototype.inputElemHandler=function(e){if("focus"==e.type)this.dtbox||(this.dtbox=new n(e.target,this)),this.dtbox.visible=!0;else if("blur"==e.type&&this.dtbox&&this.dtbox.visible){var t=this;setTimeout((function(){t.dtbox.cancelBlur>0?t.dtbox.cancelBlur-=1:(t.dtbox.visible=!1,t.inputElem.blur())}),100)}},n.prototype.setup=function(){Object.defineProperties(this.el,{wrapper:{value:null,configurable:!0},header:{value:null,configurable:!0},body:{value:null,configurable:!0},footer:{value:null,configurable:!0}}),this.setupWrapper(),this.settings.config.showDate&&(this.setupHeader(),this.setupBody()),this.settings.config.showTime&&this.setupFooter();var e=this;this.addHandler("visible",(function(t,n){if(t.visible&&!n.visible){document.body.appendChild(this.el.wrapper);var i=e.elem.value.split(/\s*,\s*/),r=void 0,o=0;e.settings.config.showDate&&(r=l(i[0],e.settings)),e.settings.config.showTime&&(o=(o=d(i[i.length-1],e.settings))||0),r&&r.getTime()||(r=new Date,r=new Date(r.getFullYear(),r.getMonth(),r.getDate()));var s=new Date(r.getTime()+o);e.value=s,e.year=s.getFullYear(),e.month=s.getMonth(),e.day=s.getDate(),e.hours=s.getHours(),e.minutes=s.getMinutes(),e.seconds=s.getSeconds(),e.settings.config.showDate&&(e.setHeaderContent(),e.setBodyContent()),e.settings.config.showTime&&e.setFooterContent()}else!t.visible&&n.visible&&document.body.removeChild(this.el.wrapper)}))},n.prototype.setupWrapper=function(){if(!this.el.wrapper){var e=document.createElement("div");e.classList.add("date-selector-wrapper"),Object.defineProperty(this.el,"wrapper",{value:e})}var t=this,n=document.getElementsByTagName("html")[0];function r(e){var r=i(t.elem),o=t.settings.config,s=o.paddingY||5,a=o.paddingX||5,l=r.top+t.elem.offsetHeight+s,d=r.left+a,h=n.clientHeight-r.top+s;t.el.wrapper.style.left=`${d}px`,r.top>300&&"BOTTOM"!=o.direction?(t.el.wrapper.style.bottom=`${h}px`,t.el.wrapper.style.top=""):(t.el.wrapper.style.top=`${l}px`,t.el.wrapper.style.bottom="")}function o(e){t.cancelBlur+=1,setTimeout((function(){t.elem.focus()}),50)}r(),this.setPosition=r,this.el.wrapper.addEventListener("mousedown",o,!1),this.el.wrapper.addEventListener("touchstart",o,!1),window.addEventListener("resize",this.setPosition)},n.prototype.setupHeader=function(){if(!this.el.header){var e=document.createElement("div"),t=["cal-nav-prev","cal-nav-current","cal-nav-next"];e.classList.add("cal-header");for(var n=0;n<3;n++){var i=document.createElement("div");i.classList.add("cal-nav",t[n]),i.onclick=this.onHeaderChange.bind(this),e.appendChild(i)}e.children[0].innerHTML="&lt;",e.children[2].innerHTML="&gt;",Object.defineProperty(this.el,"header",{value:e}),o(e,this.el.wrapper)}this.setHeaderContent()},n.prototype.setHeaderContent=function(){var e=this.year;if("DAYS"==this.bodyType)e=this.month_long+" "+e;else if("YEARS"==this.bodyType){var t=this.year+10-this.year%10;e=t-10+"-"+(t-1)}this.el.header.children[1].innerText=e},n.prototype.setupBody=function(){if(!this.el.body){var e=document.createElement("div");e.classList.add("cal-body"),Object.defineProperty(this.el,"body",{value:e}),o(e,this.el.wrapper)}var t=null;function n(e,t,n,i,r){var o=document.createElement("div");o.classList.add(n);for(var s=1;s<e+1;s++){var a=document.createElement("div");a.classList.add("cal-row","cal-row-"+s),1==s&&i&&a.classList.add(i);for(var l=1;l<t+1;l++){var d=document.createElement("div");d.classList.add("cal-cell","cal-col-"+l),d.onclick=r,a.appendChild(d)}o.appendChild(a)}return o}if("DAYS"===this.bodyType){if(!(t=this.el.body.calDays)){t=n(7,7,"cal-days","cal-day-names",this.onDateSelected.bind(this));for(var i=0;i<7;i++){var s=t.children[0].children[i];s.innerText=this.weekdays[i],s.onclick=null}this.el.body.calDays=t}}else if("MONTHS"===this.bodyType){if(!(t=this.el.body.calMonths)){t=n(3,4,"cal-months",null,this.onMonthSelected.bind(this));for(i=0;i<3;i++)for(var a=0;a<4;a++){var l=this.months_short[4*i+a];t.children[i].children[a].innerText=l}this.el.body.calMonths=t}}else"YEARS"===this.bodyType&&((t=this.el.body.calYears)||(t=n(3,4,"cal-years",null,this.onYearSelected.bind(this)),this.el.body.calYears=t));r(this.el.body),o(t,this.el.body),this.setBodyContent()},n.prototype.setBodyContent=function(){var e=this.el.body.children[0],t=["cal-cell-prev","cal-cell-next","cal-value"];if("DAYS"===this.bodyType){var n=864e5,i=new Date(this.year,this.month,1),r=new Date(i.getTime()-n*i.getDay());e.children[6].style.display="";for(var o=1;o<7;o++)for(var s=0;s<7;s++){var a=e.children[o].children[s],l=r.getMonth(),d=r.getDate();if(a.innerText=d,a.classList.remove(t[0],t[1],t[2]),l!=this.month){if(6==o&&0==s){e.children[6].style.display="none";break}a.classList.add(l<this.month?t[0]:t[1])}else c(r,this.value)&&a.classList.add(t[2]);r=new Date(r.getTime()+n)}}else if("YEARS"===this.bodyType){var h=this.year-this.year%10-1;for(o=0;o<3;o++)for(s=0;s<4;s++)e.children[o].children[s].innerText=h,h+=1;e.children[0].children[0].classList.add(t[0]),e.children[2].children[3].classList.add(t[1])}},n.prototype.onTimeChange=function(e){if(e.stopPropagation(),"mousedown"!=e.type){var t=e.target;if(this[t.name]=parseInt(t.value)||0,this.setupFooter(),"change"==e.type){var n=this;setTimeout((function(){n.elem.focus()}),50)}this.setInputValue()}else this.cancelBlur+=1},n.prototype.setupFooter=function(){if(!this.el.footer){var e=document.createElement("div"),t=this.onTimeChange.bind(this),n=this;function i(t,i,r,o){var s=document.createElement("div");s.classList.add("cal-time");var a=s.appendChild(document.createElement("div"));a.classList.add("cal-time-label"),a.innerText=t;var l=s.appendChild(document.createElement("div"));l.classList.add("cal-time-value"),l.innerText="00";var d=s.appendChild(document.createElement("div")),h=d.appendChild(document.createElement("input"));Object.assign(h,{step:1,min:0,max:r,name:i,type:"range"}),Object.defineProperty(e,i,{value:h}),d.classList.add("cal-time-slider"),h.onchange=o,h.oninput=o,h.onmousedown=o,n[i]=n[i]||parseInt(h.value)||0,e.appendChild(s)}i("HH:","hours",23,t),i("MM:","minutes",59,t),i("SS:","seconds",59,t),e.classList.add("cal-footer"),Object.defineProperty(this.el,"footer",{value:e}),o(e,this.el.wrapper)}this.setFooterContent()},n.prototype.setFooterContent=function(){if(this.el.footer){var e=this.el.footer;e.hours.value=this.hours,e.children[0].children[1].innerText=p(this.hours,2),e.minutes.value=this.minutes,e.children[1].children[1].innerText=p(this.minutes,2),e.seconds.value=this.seconds,e.children[2].children[1].innerText=p(this.seconds,2)}},n.prototype.setInputValue=function(){var e=new Date(this.year,this.month,this.day),t=[];if(this.settings.config.showDate&&t.push(h(e,this.settings)),this.settings.config.showTime){var n=new Date(e.getTime()+this.time);t.push(u(n,this.settings))}this.elem.value=t.join(", ")},n.prototype.onDateSelected=function(e){var t=e.target.parentNode,n=parseInt(e.target.innerText);t.nextSibling&&t.nextSibling.nextSibling||!(n<8)?t.previousSibling&&t.previousSibling.previousSibling||!(n>7)||(this.month-=1):this.month+=1,this.day=parseInt(e.target.innerText),this.value=new Date(this.year,this.month,this.day),this.setInputValue(),this.setHeaderContent(),this.setBodyContent()},n.prototype.onMonthSelected=function(e){var t=0,n=2,i=e.target;i.parentNode.nextSibling&&(n=i.parentNode.previousSibling?1:0),i.previousSibling&&(t=3,i.nextSibling&&(t=i.previousSibling.previousSibling?2:1)),this.month=4*n+t,this.bodyType="DAYS",this.setHeaderContent(),this.setupBody()},n.prototype.onYearSelected=function(e){this.year=parseInt(e.target.innerText),this.bodyType="MONTHS",this.setHeaderContent(),this.setupBody()},n.prototype.onHeaderChange=function(t){var n=t.target;if(n.previousSibling&&n.nextSibling){var i=e.indexOf(this.bodyType);if(i<0||!e[i+1])return;this.bodyType=e[i+1],this.setupBody()}else{var r=n.previousSibling?1:-1;switch(this.bodyType){case"DAYS":this.month+=1*r;break;case"MONTHS":this.year+=1*r;break;case"YEARS":this.year+=10*r}(this.month>11||this.month<0)&&(this.year+=Math.floor(this.month/11),this.month=this.month>11?0:11)}this.setHeaderContent(),this.setBodyContent()},s.prototype.add=function(e,t){this._funcs[e]||(this._funcs[e]=[]),this._funcs[e].push(t)},s.prototype.get=function(e){return this._funcs[e]?this._funcs[e]:[]},window.dtsel=Object.create({},{DTS:{value:t},DTObj:{value:n},fn:{value:Object.defineProperties({},{empty:{value:r},appendAfter:{value:function(e,t){t.parentNode.insertBefore(e,t.nextSibling)}},getOffset:{value:i},parseDate:{value:l},renderDate:{value:h},parseTime:{value:d},renderTime:{value:u},setDefaults:{value:function e(t,n){for(var i=Object.keys(n),r=0;r<i.length;r++){var o=i[r];Array.isArray(o)?e(t[o],n[o]):Object.prototype.hasOwnProperty.call(t,o)||(t[o]=n[o])}return t}}})}})}();