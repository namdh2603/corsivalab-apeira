jQuery((function(e){var t=e(document).find(".ywpar-points-collected__popup_wrapper"),n=!1,o=function(e,o){n=yith.ui.modal({title:e,content:t,classes:{wrap:"ywpar-points-update-wrapper"},footer:'<a href="#" class="yith-plugin-fw__button--primary form-submit float-right">'+o+"</a>"})};e(document).on("click",".ywpar-customer-list #doaction",(function(t){t.preventDefault(),t.stopPropagation(),"reset"===e("#bulk-action-selector-top").val()?yith.ui.confirm({title:yith_ywpar_customer_panel.reset_points_title,message:yith_ywpar_customer_panel.reset_points_message_bulk,confirmButtonType:"delete",confirmButton:yith_ywpar_customer_panel.remove_points_save,closeAfterConfirm:!0,onConfirm:function(){window.onbeforeunload=null,e("#posts-filter").submit()}}):e("#posts-filter").submit()})),e(document).on("click",".yith-plugin-fw__action-button--add-action",(function(e){e.preventDefault(),e.stopPropagation(),t.find("form").find('input[name="action_type"]').val("add"),o(yith_ywpar_customer_panel.add_points_title,yith_ywpar_customer_panel.add_points_save)})),e(document).on("click",".yith-plugin-fw__action-button--remove-action",(function(e){e.preventDefault(),e.stopPropagation(),t.find("form").find('input[name="action_type"]').val("remove"),o(yith_ywpar_customer_panel.remove_points_title,yith_ywpar_customer_panel.remove_points_save)})),e(document).on("click",".yith-plugin-fw__action-button--reset-action a",(function(t){t.preventDefault(),t.stopPropagation();var n=e(this).attr("href");yith.ui.confirm({title:yith_ywpar_customer_panel.reset_points_title,message:yith_ywpar_customer_panel.reset_points_message,confirmButtonType:"delete",confirmButton:yith_ywpar_customer_panel.remove_points_save,closeAfterConfirm:!0,onConfirm:function(){window.location.href=n}})})),e(document).on("click",".form-submit",(function(o){o.preventDefault();var a=e(this),i=a.closest(".yith-plugin-fw__modal__main").find("form");if("remove"===i.find('[name="action_type"]').val()){var r=parseFloat(i.find('[name="max_points_to_remove"]').val()),s=parseFloat(i.find("#points_amount").val());""!==r&&r<s&&i.find("#points_amount").val(r)}a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.ajax({url:yith_ywpar_customer_panel.ajax_url+"?action=ywpar_update_points&context=admin_action",data:t.find("form").serialize(),type:"POST",beforeSend:function(){a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(e){e.success?(a.unblock(),n.close(),window.onbeforeunload=null,window.location.reload()):console.log(e.error)}})}));e("#yith_woocommerce_points_and_rewards_bulk_form");e("#ywpar_bulk_action_points").on("click",(function(t){t.preventDefault(),window.onbeforeunload="";var n=e(this).closest("form"),o=n.serializeArray(),i=e("#yith_woocommerce_points_and_rewards_bulk-container");"from"!==o.ywpar_apply_points_previous_order_to||""!==o.ywpar_apply_points_previous_order?(i.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),e(".ywpar-bulk-trigger").append('<div class="ywpar-bulk-progress"><div>0%</div></div>'),a(1,o,n)):e("#ywpar_apply_points_previous_order").addClass("ywpar-error")}));var a=function(t,n,o){var i=e(".ywpar-bulk-trigger"),r=e("#yith_woocommerce_points_and_rewards_bulk-container");n.push({name:"action",value:"ywpar_bulk_action"},{name:"step",value:t}),e.ajax({type:"POST",url:yith_ywpar_customer_panel.ajax_url,data:n,dataType:"json",success:function(t){t.success?"done"===t.data.step?(i.find(".ywpar-bulk-progress").hide("slow").remove(),e(document).find(".ywpar-bulk-trigger").append('<span class="ywpar-bulk-response"><i class="yith-icon yith-icon-check"></i>'+t.data.message+"</span>"),r.unblock(),setTimeout((function(){e("span.ywpar-bulk-response").remove(),window.location.reload()}),2e3)):(i.find(".ywpar-bulk-progress div").html(t.data.percentage+"%"),i.find(".ywpar-bulk-progress div").animate({width:t.data.percentage+"%"},50,(function(){})),a(parseInt(t.data.step),n,o)):(e(document).find(".ywpar-bulk-trigger").append('<span class="ywpar-bulk-response"><i class="yith-icon yith-icon-check"></i>'+t.data.error+"</span>"),setTimeout((function(){e("span.ywpar-bulk-response").remove(),window.location.reload()}),2e3))}})};e.fn.serializefiles=function(){var t=e(this),n=new FormData,o=e(t).serializeArray();return e.each(o,(function(e,t){n.append(t.name,t.value)})),n},e.fn.serializeObject=function(){var t={},n=this.serializeArray();return e.each(n,(function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""})),t};var i=function(){e(document).find("#ywpar_enable_ranking").is(":checked")?e("tr.yith-plugin-fw-panel-wc-row.html").show():e("tr.yith-plugin-fw-panel-wc-row.html").hide()};i(),e(document).on("click","#ywpar_enable_ranking",i)}));